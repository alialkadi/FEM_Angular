<div class="service-explorer">
    <!-- ===============================
       HEADER
  =============================== -->
    <header class="explorer-header">
        <h2>Service Explorer</h2>
    </header>
    <!-- ===============================
       CATEGORY
  =============================== -->
    <section *ngIf="!selectedCategory">
        <h3>Choose Category</h3>
        <div class="grid">
            <div class="item-card" *ngFor="let c of categories" (click)="selectCategory(c)"> {{ c.name }} </div>
        </div>
    </section>
    <!-- ===============================
       CATEGORY TYPE
  =============================== -->
    <section *ngIf="selectedCategory && !selectedType">
        <h3>Choose Type</h3>
        <div class="grid">
            <div class="item-card" *ngFor="let t of types" (click)="selectType(t)"> {{ t.name }} </div>
        </div>
    </section>
    <!-- ===============================
       STRUCTURES
  =============================== -->
    <section *ngIf="structures.length">
        <h3>Choose Structure</h3>
        <div class="grid">
            <div class="item-card" *ngFor="let s of structures" (click)="selectItem(s)"> {{ s.name }} </div>
        </div>
    </section>
    <!-- ===============================
       PARTS
  =============================== -->
    <section *ngIf="parts.length">
        <h3>Choose Part</h3>
        <div class="grid">
            <div class="item-card" *ngFor="let p of parts" (click)="selectItem(p)"> {{ p.name }} </div>
        </div>
    </section>
    <!-- ===============================
       OPTIONS
  =============================== -->
    <section *ngIf="options.length">
        <h3>Choose Option</h3>
        <div class="grid">
            <div class="item-card" *ngFor="let o of options" (click)="selectItem(o)"> {{ o.name }} </div>
        </div>
    </section>
    <!-- ===============================
       FILTERS (SERVICES ONLY)
  =============================== -->
    <section *ngIf="filters.length">
        <details class="filters">
            <summary>Filters</summary>
            <div class="filter-group" *ngFor="let f of filters">
                <strong>{{ f.name }}</strong>
                <label *ngFor="let v of f.values">
                    <input type="checkbox" (change)="toggleFilter(f.code, v.id)"
                        [checked]="selectedFilters[f.code]?.includes(v.id)" /> {{ v.displayName }} </label>
            </div>
        </details>
    </section>
    <!-- ===============================
       SERVICES
  =============================== -->
    <section *ngIf="services.length">
        <h3>Select Services</h3>
        <div class="grid services">
            <div class="service-card" *ngFor="let s of services" (click)="selectItem(s)"
                [class.selected]="isServiceSelected(s)">
                <strong>{{ s.name }}</strong>
                <div class="meta">
                    <span class="chip" *ngFor="let m of s.metadata"> {{ m.valueText || m.value }} </span>
                </div>
            </div>
        </div>
    </section>
    <!-- ===============================
       FOOTER
  =============================== -->
    <footer class="summary-footer" *ngIf="selectedServices.length">
        <button (click)="requestServices()"> Request Services ({{ selectedServices.length }}) </button>
    </footer>
</div>